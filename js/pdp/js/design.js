var mst=jQuery.noConflict();mst(document).ready(function(e){function n(e){e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2)}function s(){var t=e("#upload_custom_image");f(0);var n=new FormData;e.each(o,function(e,t){if(t.upload)n.append(t.name,t.file)});while(o.length>0){o.pop()}var r=e("#upload_images_form").attr("action");e.ajax({url:r,data:n,cache:false,contentType:false,processData:false,type:"POST",success:function(e){f(100);if(e!=""){l(e)}},xhr:function(){xhr=e.ajaxSettings.xhr();xhr.upload.onprogress=f;xhr.upload.onloadend=f;return xhr}})}function u(t){var n=t.target.files;var r=t.target.name;e.each(n,function(e,t){if(t.type.match("image/")){o.push({name:r,file:t,upload:true})}else{alert("Please upload a file in one of the following formats: .svg, .jpg, .png, .jpeg, .bmp, .gif");document.getElementById("upload_images_form").reset()}})}function a(e,t){return Math.round(t?e*100/t:100).toString()+"%"}function f(t){var n=e.type(t),r=n=="object"&&t.lengthComputable?a(t.loaded,t.total):n=="number"?t+"%":n=="string"?t:"0%";e("#response").html(r);if(r=="100%"){e("#response").hide()}else{e("#response").show()}}function l(t){var n=e.parseJSON(t);if(n.length){e.each(n,function(t,n){e("#lists_img_upload").append("<span><img color='' src='"+n+"' alt='Custom Upload Image'/></span>")})}document.getElementById("upload_images_form").reset()}var t=e("#url_site").val().replace("index.php/","");PDPsetting.add_html();PDPsetting.init();if(e("#fb_get_id").val()!=""){e(".add_artwork_tab").click();e(".tab_design_image .facebook_api").click()}e("#facebook_album").change(function(){var t=e(this).val();e("#fb_image_list li:not(."+t+")").hide();e("#fb_image_list li.fb_album_"+t).show()});var r=t;var i=r+"media/pdp/images/artworks/";e(".content_designs").append('<span class="loading-img nodisplay">&nbsp;</span>');Paging={init:function(){this.loadMoreImage();this.filterByCategory()},loadMoreImage:function(){e("#load_more_image").click(function(){var t=e("#image_category_list li.active").attr("cr_act");var n=e("#image_category_list li.active span").attr("id");var s=e("#default_page_size").val();e.ajax({type:"POST",url:r+"index.php/pdp/index/loadMoreImage",data:{current_page:t,category:n,page_size:s},beforeSend:function(){e(".content_designs .loading-img").show()},error:function(){},success:function(n){if(n!="nomore"){e("#image_category_list li.active").attr("cr_act",parseInt(t)+1);var r=e.parseJSON(n);var s="",o;for(var u=0;u<r.length;u++){o=r[u].color_img;if(o!=""){o="fff__"+r[u].filename+","+r[u].color_img}s+="<li cat='"+r[u].category+"'> <a class='selection_img' rel='clover'><img color='"+o+"' src='"+i+r[u].filename+"' id='img"+r[u].image_id+"' price='"+r[u].price+"' image_name='"+r[u].image_name+"' color_type='"+r[u].color_type+"'/></a> </li>"}e("#icon_list").append(s)}else{alert("No more items to load!")}e(".content_designs .loading-img").hide()}})})},filterByCategory:function(){e("#image_category_list li").click(function(){e("#image_category_list").slideToggle(0);if(e(this).hasClass("active")){return}var t=e(this).find("span").html();e("label.design_label .pdp_selected_category").html(t);e("#image_category_list li.active").removeClass("active");e(this).addClass("active");e("#icon_list li[cat!="+e(this).children("span").attr("id")+"]").hide();e("#icon_list li[cat="+e(this).children("span").attr("id")+"]").show();if(!e(this).hasClass("cat_loaded")){e(this).addClass("cat_loaded");var n=2,s=e("#image_category_list li.active span").attr("id"),o=e("#default_page_size").val(),u=parseInt(n-1)*parseInt(o);e.ajax({type:"POST",url:r+"index.php/pdp/index/loadMoreImage",data:{current_page:1,category:s,page_size:u},beforeSend:function(){e(".content_designs .loading-img").show()},error:function(){},success:function(t){if(t!="nomore"){var n=e.parseJSON(t);var r="",s;for(var o=0;o<n.length;o++){s=n[o].color_img;if(s!=""){s="fff__"+n[o].filename+","+n[o].color_img}r+="<li cat='"+n[o].category+"'> <a class='selection_img' rel='clover'><img color='"+s+"' src='"+i+n[o].filename+"' id='img"+n[o].image_id+"' price='"+n[o].price+"' image_name='"+n[o].image_name+"' color_type='"+n[o].color_type+"'/></a> </li>"}e("#icon_list").append(r);e("#image_category_list li.active").attr("cr_act",2)}else{alert("No more items to load!")}e(".content_designs .loading-img").hide()}})}})}};Paging.init();e("#fileToUpload").hover(function(){if(!e(this).hasClass("active")){document.getElementById("fileToUpload").addEventListener("change",u,false);e(this).addClass("active")}});e("#upload_custom_img_btn").click(function(){if(!o.length){return false}if(!e("#agreement").is(":checked")){alert(e("#agreement_warming").val());return false}s()});var o=[];PDPAction={doRequest:function(t,n,r){e.ajax({type:"POST",url:t,data:n,beforeSend:function(){e(".pdploading").show()},error:function(){console.log("Something went wrong...")},success:function(t){r(t);e(".pdploading").hide()}})},deferredRequest:function(t,n,r){var i=e.Deferred();return e.ajax({type:"POST",url:t,data:n,beforeSend:function(){e(".pdploading").show()},error:function(){console.log("Something went wrong...")},success:function(e){r(e);i.resolve()}})},save_json_file:function(e){},save_cr_design:function(t){var n={inlay:e("#pdp_side_items li.active").attr("inlay"),side:e("#pdp_side_items li.active").attr("tab"),img:e("#pdp_side_items li.active").attr("side_img"),items:[]};var r=e("#skin_url").val(),i=e("#base_dir").val(),s=e("#media_url").val(),o=e("#pdp_side_items li.active").attr("tab"),u,a,f=e("#product_id").val();resetTextForm();var l=e("#edit_id").val();var c=0;e(".product-image .active").removeClass("active");return n},pdp_add_to:function(){var t=[];e(".pdp_info_save").each(function(){var n=e(this).attr("alt"),r=e("#pdp_side_items li[tab="+n+"]").attr("side_img");json_obj={name:n,img:r,json:e(this).val()};if(e(".design-color-image li.active").length>0){json_obj.color=e(".design-color-image li.active").attr("id")}t.push(json_obj)});var n=JSON.stringify(t),r=e("#pdp_btn_action").val();switch(r){case"pdp_add_to_cart":LoadDesign.updatePDPCustomOption(n);e("#pdp_design_popup").hide();e(".add-to-cart .btn-cart").click();break;case"pdp_add_to_wishlist":LoadDesign.updatePDPCustomOption(n);e("#pdp_design_popup").hide();if(e("#wishlist_item_id").val()!=""){e(".add-to-links .link-compare").each(function(){if(e(this).attr("onclick")!=""){e(this).click();return}})}else{e(".add-to-links .link-wishlist").click()}break;case"pdp_save_admin_sample":var i=e("#url_site").val()+"pdp/index/saveAdminTemplate";currentProductId=e("#current_product_id").val(),data={product_id:currentProductId,pdp_design:n};this.doRequest(i,data,function(){});break;case"save_before_share":this.saveBeforeShare(n);break;case"save_design_btn":LoadDesign.updatePDPCustomOption(n);e("#pdp_design_popup .overlay").click();break}},saveBeforeShare:function(t){var n=e("#save_design_url").val(),r=e("#product_url").val(),i={pdpdesign:t,url:r};this.doRequest(n,i,this.activeAddThis)},activeAddThis:function(t){var n=e.parseJSON(t);for(var r=0;r<addthis.links.length;r++){addthis.links[r].share.url=n.url}e(".social-bottom .overlay-btn").addClass("send-back")},pdpBtnClick:function(){e(".pdp-btn").on("click",function(){e("#pdp_btn_action").val(e(this).attr("id"));PDPAction.save_cr_design("done")})},loadFonts:function(){var t=r+"index.php/pdp/index/loadFonts";e.ajax({type:"GET",url:t,beforeSend:function(){console.log("Load Font")},error:function(){console.log("Something went wrong...")},success:function(t){e(".fonts-container").html(t)}})}};PDPAction.pdpBtnClick()})